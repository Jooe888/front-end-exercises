<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="./js/promise.js"></script>
    <title>自定义 promise</title>
  </head>
  <body>
    <script>
      // let p = new Promise((resolve, reject) => {
      //   setTimeout(() => {
      //     resolve('OK');
      //     // reject('error');
      //     // throw 'error';
      //   }, 1000);
      //   // reject('error');
      //   // resolve('OK');
      //   // reject('error');
      //   // throw 'error';
      // });
      // let res = p.then(
      //   value => {
      //     console.log(value);
      //     throw 'error';
      //     // return 'hello';
      //   },
      //   reason => {
      //     console.log(reason);
      //     throw 'error';
      //     // return 'error';
      //   }
      // );

      // console.log(res);
      const url =
        'http%3a%2f%2f127.0.0.1%3a8666%2fweb%2fauthui%2f%23access_token%3dTGT-4-L2B6vKlbaND0XRo4jtFHgBgjcZcYvaIYIV0u5TLimB4cIQni3e-isc.sgcc.com.cn%26state%3d7308cad2-aeae-4959-8e9d-df2f6a0b111f%26expires%3d7200%26token_type%3dbearer';

      console.log('url', decodeURIComponent(url));

      getQueryVariable = (url, variable) => {
        const r = /access_token=|&/;
        const arr = decodeURIComponent(url).split(r);
        console.log(arr);
        let query, vars;

        if (arr[1]) {
          query = arr[1];
        } else {
          return '';
        }
        const re = /[&#]/;
        vars = query.split(re);
        for (let i = 0; i < vars.length; i++) {
          const pair = vars[i].split('=');
          if (pair[0] === variable) {
            return pair[1];
          }
        }
        return '';
      };
      console.log('token:', getQueryVariable(url, 'access_token'));
    </script>
  </body>
</html>
